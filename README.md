# Causal Prior-Embedded Physics-Informed Neural Networks and a Metformin Case Study
Data and code associated with the manuscript "Causal Prior-Embedded Physics-Informed Neural Networks and a Case Study on Metformin Transport in Porous Media," published in [*Water Research*](https://doi.org/10.1016/j.watres.2024.121985).

This repository contains:
1. The augmented datasets generated by Phydrus/Hydrus-1D.
   - **df_causal.csv**:  Used for causal effect estimation;
   - **df_NN.parquet**: Used for neural network experiments.
2. Structural Causal Model ATE regression, based on DoWhy.
   - **scm.ipynb**: The working notebook for SCM causal inference.
3. A neural network framework /w *causal weight initialization* and *causal regularization* implemented (Ref1)
   - **model_causal_reg.py**: Main program, PyTorch required
   - **set_random_seed.py**: Randomizer file.
4. [NNI](https://github.com/microsoft/nni) (Ref2) configuration related files. 
   - **search_space.json**: Example search space configuration for NNI
   - **config-example.yaml**: Example experiment configuration for NNI
   For a detailed instruction on using NNI, please refer to [NNI Documentation](https://nni.readthedocs.io/en/stable/)

The following files/code may be available upon request at this stage. 
1. Phydrus code (to generate augmented data)
2. Our NNI experiment results (1,440 runs)
3. All code to reproduce visualizations


References

(1) Kancheti, S. S., Reddy, A. G., Balasubramanian, V. N., & Sharma, A. (2021). Matching learned causal effects of neural networks with domain priors. arXiv preprint arXiv:2111.12490.

(2) Microsoft. (2021). Neural Network Intelligence (Version 2.0) [Computer software]. 
